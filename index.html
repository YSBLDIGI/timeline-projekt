<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8">
<title>Meine Timeline</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- TimelineJS-Stile -->
<link title="timeline-styles" rel="stylesheet" href="https://cdn.knightlab.com/libs/timeline3/latest/css/timeline.css">

<!-- Google Fonts (Roboto: 300/400/700) -->
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">

<style>
/* CI/CD: Fonts, Farben und Layout */
body {
  margin: 0;
  padding: 0;
  height: 100vh;
  font-family: 'Roboto', sans-serif;
  background-color: #ffffff;
}

/* Titel / Headlines */
.tl-slide .tl-headline {
  font-family: 'Roboto', sans-serif !important;
  color: #ff0000 !important;          /* BL-Rot */
  font-weight: 400 !important;         /* nicht fett */
  font-size: 22px !important;
  line-height: 1.3 !important;
  text-transform: none !important;     /* Groß-/Kleinschreibung beibehalten */
}

/* Fließtext */
.tl-slide .tl-text-content {
  font-family: 'Roboto', sans-serif !important;
  font-weight: 300 !important;
  color: #000000 !important;
  font-size: 16px !important;
  line-height: 1.5 !important;
}

/* Slide-Hintergrund */
.tl-slide-content {
  background-color: #e6f2f2 !important; /* Grau-Blau 01 */
}

/* Datum / Zeitachsen-Beschriftungen */
.tl-timeaxis-tick-text,
.tl-timeaxis .tl-timeaxis-major,
.tl-timeaxis .tl-timeaxis-minor,
.tl-slide .tl-headline-date,
.tl-slide .tl-date {
  font-family: 'Roboto', sans-serif !important;
  text-transform: none !important;     /* nichts erzwingen */
  color: #858c8c !important;           /* Grau-Blau 03 */
}

/* Jahresgruppen */
.tl-timegroup-message {
  font-family: 'Roboto', sans-serif !important;
  background-color: #555959 !important; /* Grau-Blau 04 */
  color: #ffffff !important;
  font-weight: 300 !important;
}

/* Symbole links unten */
.tl-menubar-button {
  width: clamp(28px, 4vh, 36px) !important;
  height: clamp(28px, 4vh, 36px) !important;
  font-size: clamp(16px, 2vh, 20px) !important;
}
.tl-menubar { padding: 6px !important; }

/* Navigationstitel/-beschreibung */
.tl-slidenav-title,
.tl-slidenav-description {
  font-family: 'Roboto', sans-serif !important;
  text-transform: none !important;
  font-weight: 300 !important;
}

/* Mobile */
@media (max-width: 600px) {
  .tl-media,
  .tl-media .tl-media-content,
  .tl-media .tl-media-image img,
  .tl-media .tl-media-iframe iframe {
    max-height: 35vh !important;
    height: auto !important;
    width: 100% !important;
    object-fit: cover !important;
  }
  .tl-slide .tl-headline {
    font-size: 18px !important;
    line-height: 1.25 !important;
  }
  .tl-slide .tl-text-content {
    font-size: 14px !important;
    line-height: 1.4 !important;
  }
  .tl-timeaxis-tick-text {
    font-size: 12px !important;
  }
  .tl-timegroup-message {
    font-size: 13px !important;
    padding: 4px 8px !important;
  }
}

/* Fix: Uppercase auf Datumszeile über dem Titel zuverlässig deaktivieren */
#timeline-embed .tl-slide .tl-headline-date,
#timeline-embed .tl-slide .tl-headline-date *,
#timeline-embed .tl-slide .tl-headline .tl-headline-date,
#timeline-embed .tl-slide .tl-text .tl-headline-date,
#timeline-embed .tl-slide .tl-headline-date .tl-headline-date-text,
#timeline-embed .tl-slide .tl-headline-date .tl-date,
#timeline-embed .tl-slide .tl-headline-date .tl-date-display {
  text-transform: none !important;
  letter-spacing: normal !important; /* falls Timeline die Abstände für Uppercase erhöht */
}

/* === Roboto für alle Texte – Icon-Fonts explizit ausnehmen === */

/* 1) Roboto standardmäßig für Text */
#timeline-embed,
#timeline-embed * {
  font-family: 'Roboto', system-ui, -apple-system, Segoe UI, Arial, sans-serif !important;
}

/* 2) AUSNAHMEN: Icon-Fonts & Navigationspfeile NICHT überschreiben */
#timeline-embed [class^="tl-icon"],
#timeline-embed [class*=" tl-icon"],
#timeline-embed .tl-slidenav-next,
#timeline-embed .tl-slidenav-previous,
#timeline-embed .tl-slidenav-icon,
#timeline-embed .tl-menubar-button .tl-icon,
#timeline-embed .tl-menubar-button .tl-button-icon,
#timeline-embed .tl-menubar-button [class^="tl-icon"],
#timeline-embed .tl-menubar-button [class*=" tl-icon"] {
  font-family: revert !important;   /* nimmt die Icon-Font aus timeline.css */
  font-style: revert !important;
  font-weight: revert !important;
}

/* 3) SVG-Beschriftungen (Zeitachse, Marker) weiterhin Roboto */
#timeline-embed svg text,
#timeline-embed .tl-timeaxis svg text {
  font-family: 'Roboto', system-ui, -apple-system, Segoe UI, Arial, sans-serif !important;
}

/* 4) Typische Textbereiche extra absichern (optional) */
#timeline-embed .tl-slide,
#timeline-embed .tl-headline,
#timeline-embed .tl-headline-date,
#timeline-embed .tl-text-content,
#timeline-embed .tl-timegroup-message,
#timeline-embed .tl-caption,
#timeline-embed .tl-credit,
#timeline-embed .tl-attribution,
#timeline-embed .tl-message,
#timeline-embed .tl-slidenav-title,
#timeline-embed .tl-slidenav-description {
  font-family: 'Roboto', system-ui, -apple-system, Segoe UI, Arial, sans-serif !important;
}

/* 5) Glättung (v. a. Windows) */
#timeline-embed {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
</style>
</head>
<body>
<!-- Ladeanzeige -->
<div id="timeline-loader" style="text-align:center; padding:20px; font-family:'Roboto',sans-serif; color:#858c8c;">
  Lade Timeline …
</div>

<!-- Responsive Timeline-Container -->
<div id="timeline-embed" style="width: 100%; height: 100vh; display: none;"></div>

<!-- TimelineJS -->
<script src="https://cdn.knightlab.com/libs/timeline3/latest/js/timeline.js"></script>
<script>
  var options = { language: 'de', initial_zoom: 2 };
  var sheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRhR7GF-0QwHJWGfSOv17aCYvH9z3KiR5rPL1-3Li8lhPVGulJqxB3M4Rmygou29gSdBZz65ylfi_XX/pubhtml';

  window.timeline = new TL.Timeline('timeline-embed', sheetUrl, options);

  // Helfer: Monatsnamen in deutsches "Satz-Case" bringen
  const MONTH_MAP = {
    'januar':'Januar','februar':'Februar','märz':'März','april':'April','mai':'Mai','juni':'Juni',
    'juli':'Juli','august':'August','september':'September','oktober':'Oktober','november':'November','dezember':'Dezember'
  };
  const MONTH_WORDS = Object.keys(MONTH_MAP).join('|'); // regex: januar|februar|...

  function fixHeadlineDates(root=document) {
    const nodes = root.querySelectorAll('.tl-headline-date');
    nodes.forEach(el => {
      // Uppercase aus Timeline-CSS aushebeln
      el.style.textTransform = 'none';

      // Aus dem DOM zusammengesetzten Text erzeugen (inkl. verschachtelter <span>)
      const walker = document.createTreeWalker(el, NodeFilter.SHOW_TEXT);
      const textNodes = [];
      let n; while ((n = walker.nextNode())) textNodes.push(n);

      textNodes.forEach(tn => {
        let t = tn.nodeValue;

        // Normalisieren: alles klein
        const lowered = t.toLocaleLowerCase('de-DE');

        // Nur ganze Monats-Wörter ersetzen
        const fixed = lowered.replace(new RegExp(`\\b(${MONTH_WORDS})\\b`, 'g'), m => MONTH_MAP[m]);

        tn.nodeValue = fixed;
      });
    });
  }

  function onLoaded() {
    document.getElementById('timeline-loader').style.display = 'none';
    document.getElementById('timeline-embed').style.display = 'block';
    fixHeadlineDates();
  }

  window.timeline.on('loaded', onLoaded);

  // Beobachte spätere Slide-Wechsel/Neurender
  const target = document.getElementById('timeline-embed');
  const obs = new MutationObserver(() => {
    requestAnimationFrame(() => fixHeadlineDates(target));
  });
  obs.observe(target, { childList: true, subtree: true });
</script>
</body>
</html>
